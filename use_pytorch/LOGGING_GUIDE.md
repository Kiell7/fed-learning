# è®­ç»ƒæ—¥å¿—å’Œå¯è§†åŒ–åŠŸèƒ½ - ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ¬¡æ›´æ–°ä¸ºè”é‚¦å­¦ä¹ è®­ç»ƒç³»ç»Ÿæ·»åŠ äº†å®Œæ•´çš„æ—¥å¿—è®°å½•å’Œå¯è§†åŒ–åŠŸèƒ½ï¼Œå®ç°äº†æ‚¨è¦æ±‚çš„æ‰€æœ‰ç‰¹æ€§ï¼š

### âœ… å·²å®ç°çš„åŠŸèƒ½

1. **ç¼–ç é•¿åº¦æ›²çº¿** - è®°å½•ä¸‰ä¸ªç¼–ç å€¼ï¼ˆlengths: [7.3174, 5.4738, 10.0]ï¼‰éšè½®æ¬¡çš„å˜åŒ–
2. **å‡†ç¡®ç‡æ›²çº¿** - è®°å½•æ¨¡å‹å‡†ç¡®ç‡éšè½®æ¬¡çš„å˜åŒ–
3. **æŸå¤±æ›²çº¿** - è®°å½•è®­ç»ƒæŸå¤±éšè½®æ¬¡çš„å˜åŒ–  
4. **è¯¦ç»†æ—¥å¿—æ–‡ä»¶** - CSVæ ¼å¼è®°å½•æ¯ä¸€è½®çš„æ‰€æœ‰å‚æ•°

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œè®­ç»ƒ

```bash
cd /home/student4/njj/fed-learning-feature-dev/use_pytorch

# è¿è¡ŒBERTæ¨¡å‹è®­ç»ƒ
python server.py -mn bert -dsn squad -nc 20 -cf 0.5 -E 2 -B 16 -lr 0.00002 -ncomm 100 -sf 50
```

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨ï¼š
- âœ… å®æ—¶è®°å½•æ¯è½®æ•°æ®åˆ° CSV æ–‡ä»¶
- âœ… å®šæœŸä¿å­˜ checkpointï¼ˆåŒ…å«ç¼–ç é•¿åº¦ï¼‰
- âœ… è®­ç»ƒç»“æŸåç”Ÿæˆå¯è§†åŒ–æ›²çº¿

### 2. æŸ¥çœ‹è®­ç»ƒç»“æœ

è®­ç»ƒå®Œæˆåï¼Œåœ¨å®éªŒæ–‡ä»¶å¤¹ä¸­ä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

```
checkpoints/bert_squad_nc20_comm100_20251107_XXXXXX/
â”œâ”€â”€ config.json                    # å®éªŒé…ç½®
â”œâ”€â”€ training_log.csv               # ğŸ“Š è¯¦ç»†è®­ç»ƒæ—¥å¿—ï¼ˆæ¯è½®è®°å½•ï¼‰
â”œâ”€â”€ training_progress.png          # ğŸ“ˆ è®­ç»ƒæ›²çº¿ï¼ˆ4ä¸ªå­å›¾ï¼‰
â”œâ”€â”€ checkpoint_round_50.pth        # ä¸­é—´checkpoint
â”œâ”€â”€ checkpoint_round_100.pth       # æœ€ç»ˆcheckpoint
â””â”€â”€ final_model.pth                # æœ€ç»ˆæ¨¡å‹
```

---

## ğŸ“Š æ–‡ä»¶è¯´æ˜

### 1. training_log.csv - è¯¦ç»†æ—¥å¿—

CSVæ ¼å¼ï¼ŒåŒ…å«æ¯ä¸€è½®çš„æ‰€æœ‰å‚æ•°ï¼š

| Round | Accuracy | Loss | Length_1 | Length_2 | Length_3 |
|-------|----------|------|----------|----------|----------|
| 1 | 45.2340 | 1.234567 | 7.317400 | 5.473800 | 10.000000 |
| 2 | 48.5670 | 1.123456 | 7.234500 | 5.567800 | 9.890000 |
| ... | ... | ... | ... | ... | ... |

**ç‰¹ç‚¹ï¼š**
- âœ… å®æ—¶å†™å…¥ï¼ˆæ¯è½®è®­ç»ƒåç«‹å³ä¿å­˜ï¼‰
- âœ… å³ä½¿è®­ç»ƒä¸­æ–­ä¹Ÿèƒ½ä¿ç•™å·²æœ‰æ•°æ®
- âœ… å¯ç”¨Excelã€Python pandasç­‰å·¥å…·æ‰“å¼€åˆ†æ

### 2. training_progress.png - è®­ç»ƒæ›²çº¿

åŒ…å«4ä¸ªå­å›¾çš„å¯è§†åŒ–å›¾è¡¨ï¼š
1. **æŸå¤±æ›²çº¿** - å¹³å‡è®­ç»ƒæŸå¤±
2. **å‡†ç¡®ç‡æ›²çº¿** - å…¨å±€æ¨¡å‹å‡†ç¡®ç‡
3. **ç¼–ç é•¿åº¦æ›²çº¿** - ä¸‰æ¡æ›²çº¿æ˜¾ç¤ºLength 1/2/3çš„å˜åŒ–
4. **ç»¼åˆå¯¹æ¯”å›¾** - å‡†ç¡®ç‡ä¸ç¼–ç é•¿åº¦çš„å¯¹æ¯”

### 3. checkpoint_round_X.pth - æ£€æŸ¥ç‚¹æ–‡ä»¶

å¢å¼ºåçš„checkpointåŒ…å«ï¼š

```python
{
    'round': 50,                      # è½®æ¬¡
    'model_state_dict': {...},        # æ¨¡å‹å‚æ•°
    'optimizer_state_dict': {...},    # ä¼˜åŒ–å™¨çŠ¶æ€
    'accuracy': 75.23,                # å‡†ç¡®ç‡
    'loss': 0.456,                    # æŸå¤±
    'lengths': [7.3174, 5.4738, 10.0] # âœ… æ–°å¢ï¼šç¼–ç é•¿åº¦
}
```

---

## ğŸ”§ æŸ¥çœ‹æ—¥å¿—å·¥å…·

æä¾›äº†ä¸“é—¨çš„æ—¥å¿—æŸ¥çœ‹å·¥å…· `view_training_log.py`ï¼Œæ”¯æŒå¤šç§æŸ¥çœ‹æ–¹å¼ï¼š

### åŸºæœ¬ä½¿ç”¨

```bash
# 1. æŸ¥çœ‹è®­ç»ƒæ‘˜è¦
python scripts/view_training_log.py checkpoints/<å®éªŒæ–‡ä»¶å¤¹>/training_log.csv

# 2. ç”Ÿæˆè¯¦ç»†åˆ†ææŠ¥å‘Š
python scripts/view_training_log.py checkpoints/<å®éªŒæ–‡ä»¶å¤¹>/training_log.csv --report

# 3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—è®°å½•
python scripts/view_training_log.py checkpoints/<å®éªŒæ–‡ä»¶å¤¹>/training_log.csv --detailed
```

### è¾“å‡ºç¤ºä¾‹

**æŸ¥çœ‹æ‘˜è¦ï¼š**
```
============================================================
è®­ç»ƒæ‘˜è¦
============================================================

ğŸ“Š æ€»è½®æ•°: 100

ğŸ¯ å‡†ç¡®ç‡:
   æœ€é«˜: 85.23 (è½®æ¬¡ 95)
   æœ€ä½: 32.14 (è½®æ¬¡ 1)
   æœ€ç»ˆ: 84.56
   å¹³å‡: 72.34

ğŸ“‰ æŸå¤±:
   æœ€é«˜: 2.345678 (è½®æ¬¡ 1)
   æœ€ä½: 0.234567 (è½®æ¬¡ 100)
   æœ€ç»ˆ: 0.245678
   å¹³å‡: 0.987654

ğŸ“ ç¼–ç é•¿åº¦ (Length 1):
   æœ€å¤§: 8.234567 (è½®æ¬¡ 50)
   æœ€å°: 6.123456 (è½®æ¬¡ 1)
   æœ€ç»ˆ: 7.456789
   å¹³å‡: 7.234567
```

**ç”ŸæˆæŠ¥å‘Šï¼š**
- ç”Ÿæˆ `training_report.png` - 6ä¸ªå­å›¾çš„è¯¦ç»†åˆ†æ
- ç”Ÿæˆ `training_summary.txt` - æ–‡æœ¬æ ¼å¼æ‘˜è¦

---

## ğŸ“ˆ å¯è§†åŒ–è¯´æ˜

### training_progress.pngï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰

**å¸ƒå±€ï¼š2Ã—2**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æŸå¤±æ›²çº¿           â”‚  å‡†ç¡®ç‡æ›²çº¿         â”‚
â”‚  (Loss vs Round)    â”‚  (Accuracy vs Round)â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¼–ç é•¿åº¦æ›²çº¿       â”‚  å‡†ç¡®ç‡ vs ç¼–ç      â”‚
â”‚  (3æ¡çº¿)            â”‚  (åŒYè½´)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### training_report.pngï¼ˆå·¥å…·ç”Ÿæˆï¼‰

**å¸ƒå±€ï¼š3Ã—2**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‡†ç¡®ç‡æ›²çº¿         â”‚  æŸå¤±æ›²çº¿           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¼–ç é•¿åº¦æ›²çº¿       â”‚  å‡†ç¡®ç‡å˜åŒ–ç‡       â”‚
â”‚  (3æ¡çº¿)            â”‚  (Accuracy Î”)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æŸå¤±å˜åŒ–ç‡         â”‚  å‡†ç¡®ç‡ vs æŸå¤±     â”‚
â”‚  (Loss Î”)           â”‚  (åŒYè½´)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª æµ‹è¯•åŠŸèƒ½

æä¾›äº†å®Œæ•´çš„æµ‹è¯•è„šæœ¬ï¼š

```bash
# è¿è¡ŒåŠŸèƒ½æµ‹è¯•
cd /home/student4/njj/fed-learning-feature-dev/use_pytorch
python scripts/test_logging_features.py
```

æµ‹è¯•å†…å®¹ï¼š
1. âœ… CSVæ—¥å¿—è®°å½•
2. âœ… å¯è§†åŒ–æ›²çº¿ç”Ÿæˆ
3. âœ… Checkpointæ ¼å¼

---

## ğŸ’¡ é«˜çº§ç”¨æ³•

### 1. è‡ªå®šä¹‰è¾“å‡ºç›®å½•

```bash
python scripts/view_training_log.py path/to/training_log.csv --report --output /custom/path
```

### 2. æŸ¥çœ‹æ›´å¤šè¯¦ç»†è®°å½•

```bash
# æ˜¾ç¤ºå‰20è½®å’Œå20è½®
python scripts/view_training_log.py path/to/training_log.csv --detailed --rows 20
```

### 3. åœ¨Pythonä¸­ä½¿ç”¨

```python
import pandas as pd
import matplotlib.pyplot as plt

# åŠ è½½CSVæ—¥å¿—
df = pd.read_csv('checkpoints/xxx/training_log.csv')

# è‡ªå®šä¹‰åˆ†æ
print(f"å‡†ç¡®ç‡æå‡: {df['Accuracy'].iloc[-1] - df['Accuracy'].iloc[0]:.2f}%")

# è‡ªå®šä¹‰å¯è§†åŒ–
plt.figure(figsize=(10, 6))
plt.plot(df['Round'], df['Length_1'], label='Length 1')
plt.plot(df['Round'], df['Length_2'], label='Length 2')
plt.plot(df['Round'], df['Length_3'], label='Length 3')
plt.legend()
plt.savefig('custom_plot.png')
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å®æ—¶å†™å…¥** - CSVæ–‡ä»¶åœ¨æ¯è½®è®­ç»ƒåç«‹å³å†™å…¥ï¼Œè®­ç»ƒä¸­æ–­ä¸ä¼šä¸¢å¤±æ•°æ®
2. **ç¼–ç é•¿åº¦** - å¦‚æœæ¨¡å‹æ²¡æœ‰è®¡ç®—ç¼–ç é•¿åº¦ï¼Œå¯¹åº”åˆ—ä¼šæ˜¾ç¤º 'N/A'
3. **æ–‡ä»¶å¤§å°** - é•¿æ—¶é—´è®­ç»ƒä¼šäº§ç”Ÿè¾ƒå¤§çš„CSVæ–‡ä»¶ï¼Œå»ºè®®å®šæœŸå½’æ¡£
4. **å›¾è¡¨è´¨é‡** - é»˜è®¤ä»¥300 DPIä¿å­˜ï¼Œé€‚åˆè®ºæ–‡å‘è¡¨ä½¿ç”¨

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1: CSVæ–‡ä»¶ä¸ºç©º
**åŸå› **: è®­ç»ƒæœªå¼€å§‹æˆ–ç¬¬ä¸€è½®æœªå®Œæˆ  
**è§£å†³**: ç­‰å¾…è‡³å°‘å®Œæˆä¸€è½®è®­ç»ƒ

### é—®é¢˜2: å›¾è¡¨æ˜¾ç¤ºå¼‚å¸¸
**åŸå› **: matplotlibæœªå®‰è£…æˆ–ç‰ˆæœ¬ä¸å…¼å®¹  
**è§£å†³**: 
```bash
pip install matplotlib pandas numpy
```

### é—®é¢˜3: ç¼–ç é•¿åº¦æ˜¾ç¤ºN/A
**åŸå› **: æ­£å¸¸ç°è±¡ï¼ŒæŸäº›æ¨¡å‹é…ç½®ä¸è®¡ç®—ç¼–ç é•¿åº¦  
**è§£å†³**: æ— éœ€å¤„ç†ï¼Œè¿™ä¸å½±å“å…¶ä»–åŠŸèƒ½

---

## ğŸ“š æ–‡ä»¶ç´¢å¼•

| æ–‡ä»¶ | ä½ç½® | è¯´æ˜ |
|------|------|------|
| `server.py` | `use_pytorch/` | ä¸»è®­ç»ƒè„šæœ¬ï¼ˆå·²ä¿®æ”¹ï¼‰ |
| `visualization.py` | `utils/` | å¯è§†åŒ–å‡½æ•°ï¼ˆå·²å¢å¼ºï¼‰ |
| `view_training_log.py` | `use_pytorch/scripts/` | æ—¥å¿—æŸ¥çœ‹å·¥å…· |
| `test_logging_features.py` | `use_pytorch/scripts/` | åŠŸèƒ½æµ‹è¯•è„šæœ¬ |
| `README.md` | `use_pytorch/scripts/` | å·¥å…·è¯¦ç»†æ–‡æ¡£ |

---

## âœ¨ æ›´æ–°æ€»ç»“

### ä»£ç ä¿®æ”¹

1. **server.py** - æ–°å¢åŠŸèƒ½ï¼š
   - CSVæ—¥å¿—å®æ—¶è®°å½•
   - ç¼–ç é•¿åº¦ä¿å­˜åˆ°checkpoint
   - å¢å¼ºçš„å¯è§†åŒ–è°ƒç”¨

2. **visualization.py** - æ–°å¢åŠŸèƒ½ï¼š
   - æ”¯æŒç¼–ç é•¿åº¦æ›²çº¿
   - 2Ã—2å¸ƒå±€ï¼ˆæŸå¤±ã€å‡†ç¡®ç‡ã€ç¼–ç é•¿åº¦ã€ç»¼åˆå¯¹æ¯”ï¼‰
   - ç¾åŒ–å›¾è¡¨æ ·å¼

3. **æ–°å¢å·¥å…·**ï¼š
   - `view_training_log.py` - æ—¥å¿—æŸ¥çœ‹å·¥å…·
   - `test_logging_features.py` - åŠŸèƒ½æµ‹è¯•

### æ–°å¢æ–‡ä»¶

æ¯æ¬¡è®­ç»ƒè‡ªåŠ¨ç”Ÿæˆï¼š
- âœ… `training_log.csv` - è¯¦ç»†å‚æ•°è®°å½•
- âœ… `training_progress.png` - è®­ç»ƒæ›²çº¿
- âœ… `config.json` - å®éªŒé…ç½®

ä½¿ç”¨å·¥å…·å¯ç”Ÿæˆï¼š
- âœ… `training_report.png` - è¯¦ç»†åˆ†ææŠ¥å‘Š
- âœ… `training_summary.txt` - æ–‡æœ¬æ‘˜è¦

---

## ğŸ¯ ä¸‹ä¸€æ­¥

å»ºè®®å·¥ä½œæµç¨‹ï¼š

1. **è¿è¡Œè®­ç»ƒ**
   ```bash
   python server.py -mn bert -dsn squad -nc 20 -cf 0.5 -E 2 -B 16 -lr 0.00002 -ncomm 100 -sf 50
   ```

2. **ç›‘æ§è¿›åº¦**
   - è§‚å¯Ÿç»ˆç«¯è¾“å‡ºçš„ `lengths:[x.x, x.x, x.x]`
   - æŸ¥çœ‹å®æ—¶ç”Ÿæˆçš„ CSV æ–‡ä»¶

3. **åˆ†æç»“æœ**
   ```bash
   # å¿«é€ŸæŸ¥çœ‹
   python scripts/view_training_log.py checkpoints/xxx/training_log.csv
   
   # ç”ŸæˆæŠ¥å‘Š
   python scripts/view_training_log.py checkpoints/xxx/training_log.csv --report
   ```

4. **ä½¿ç”¨æ•°æ®**
   - åœ¨è®ºæ–‡ä¸­ä½¿ç”¨ç”Ÿæˆçš„å›¾è¡¨
   - ä½¿ç”¨CSVè¿›è¡Œæ·±åº¦åˆ†æ
   - å¯¹æ¯”ä¸åŒå®éªŒçš„ç»“æœ

---

**ğŸ‰ æ‰€æœ‰åŠŸèƒ½å·²å®Œæˆå¹¶æµ‹è¯•é€šè¿‡ï¼**
