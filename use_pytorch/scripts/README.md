# è®­ç»ƒæ—¥å¿—åˆ†æå·¥å…·

## åŠŸèƒ½è¯´æ˜

è¯¥å·¥å…·ç”¨äºæŸ¥çœ‹å’Œåˆ†æè”é‚¦å­¦ä¹ è®­ç»ƒè¿‡ç¨‹ä¸­ç”Ÿæˆçš„æ—¥å¿—æ–‡ä»¶ã€‚

## æ–°å¢åŠŸèƒ½

è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

### 1. è®­ç»ƒæ—¥å¿— CSV æ–‡ä»¶ (`training_log.csv`)

æ¯è½®è®­ç»ƒéƒ½ä¼šè®°å½•ä»¥ä¸‹å‚æ•°åˆ°CSVæ–‡ä»¶ï¼š
- **Round**: è½®æ¬¡ç¼–å·
- **Accuracy**: å…¨å±€æ¨¡å‹å‡†ç¡®ç‡
- **Loss**: å¹³å‡æŸå¤±
- **Length_1**: ç¼–ç é•¿åº¦ 1
- **Length_2**: ç¼–ç é•¿åº¦ 2  
- **Length_3**: ç¼–ç é•¿åº¦ 3

æ–‡ä»¶ä½ç½®ï¼š`checkpoints/<å®éªŒåç§°>/training_log.csv`

### 2. è®­ç»ƒæ›²çº¿å¯è§†åŒ– (`training_progress.png`)

è‡ªåŠ¨ç”ŸæˆåŒ…å«ä»¥ä¸‹å†…å®¹çš„å¯è§†åŒ–å›¾è¡¨ï¼š
- **æŸå¤±æ›²çº¿**: è®­ç»ƒæŸå¤±éšè½®æ¬¡å˜åŒ–
- **å‡†ç¡®ç‡æ›²çº¿**: æ¨¡å‹å‡†ç¡®ç‡éšè½®æ¬¡å˜åŒ–
- **ç¼–ç é•¿åº¦æ›²çº¿**: ä¸‰ä¸ªç¼–ç é•¿åº¦éšè½®æ¬¡å˜åŒ–
- **ç»¼åˆå¯¹æ¯”å›¾**: å‡†ç¡®ç‡ä¸ç¼–ç é•¿åº¦çš„å¯¹æ¯”

æ–‡ä»¶ä½ç½®ï¼š`checkpoints/<å®éªŒåç§°>/training_progress.png`

### 3. Checkpoint æ–‡ä»¶å¢å¼º

ç°åœ¨æ¯ä¸ªcheckpointæ–‡ä»¶éƒ½åŒ…å«ï¼š
- æ¨¡å‹çŠ¶æ€å­—å…¸
- ä¼˜åŒ–å™¨çŠ¶æ€
- å½“å‰è½®æ¬¡
- å‡†ç¡®ç‡
- æŸå¤±å€¼
- **ç¼–ç é•¿åº¦æ•°ç»„** (æ–°å¢)

## ä½¿ç”¨æ–¹æ³•

### 1. æŸ¥çœ‹è®­ç»ƒæ—¥å¿—æ‘˜è¦

```bash
python scripts/view_training_log.py checkpoints/<å®éªŒåç§°>/training_log.csv
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
âœ… æˆåŠŸåŠ è½½è®­ç»ƒæ—¥å¿—: checkpoints/bert_squad_nc20_comm100_20251107_013508/training_log.csv
   æ€»è½®æ•°: 100

============================================================
è®­ç»ƒæ‘˜è¦
============================================================

ğŸ“Š æ€»è½®æ•°: 100

ğŸ¯ å‡†ç¡®ç‡:
   æœ€é«˜: 0.8523 (è½®æ¬¡ 95)
   æœ€ä½: 0.3214 (è½®æ¬¡ 1)
   æœ€ç»ˆ: 0.8456
   å¹³å‡: 0.7234

ğŸ“‰ æŸå¤±:
   æœ€é«˜: 2.345678 (è½®æ¬¡ 1)
   æœ€ä½: 0.234567 (è½®æ¬¡ 100)
   æœ€ç»ˆ: 0.245678
   å¹³å‡: 0.987654

ğŸ“ ç¼–ç é•¿åº¦ (Length 1):
   æœ€å¤§: 8.234567 (è½®æ¬¡ 50)
   æœ€å°: 6.123456 (è½®æ¬¡ 1)
   æœ€ç»ˆ: 7.456789
   å¹³å‡: 7.234567
```

### 2. ç”Ÿæˆå®Œæ•´åˆ†ææŠ¥å‘Š

```bash
python scripts/view_training_log.py checkpoints/<å®éªŒåç§°>/training_log.csv --report
```

è¿™å°†ç”Ÿæˆï¼š
- `training_report.png`: è¯¦ç»†çš„å¯è§†åŒ–åˆ†æå›¾è¡¨ï¼ˆ6ä¸ªå­å›¾ï¼‰
  - å‡†ç¡®ç‡æ›²çº¿
  - æŸå¤±æ›²çº¿
  - ç¼–ç é•¿åº¦æ›²çº¿
  - å‡†ç¡®ç‡å˜åŒ–ç‡
  - æŸå¤±å˜åŒ–ç‡
  - å‡†ç¡®ç‡vsæŸå¤±å¯¹æ¯”
- `training_summary.txt`: æ–‡æœ¬æ ¼å¼çš„è®­ç»ƒæ‘˜è¦

### 3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

```bash
# æ˜¾ç¤ºå‰10è½®å’Œå10è½®çš„è¯¦ç»†è®°å½•
python scripts/view_training_log.py checkpoints/<å®éªŒåç§°>/training_log.csv --detailed

# æ˜¾ç¤ºå‰20è½®å’Œå20è½®
python scripts/view_training_log.py checkpoints/<å®éªŒåç§°>/training_log.csv --detailed --rows 20
```

### 4. è‡ªå®šä¹‰è¾“å‡ºç›®å½•

```bash
python scripts/view_training_log.py checkpoints/<å®éªŒåç§°>/training_log.csv --report --output /path/to/output
```

## å‘½ä»¤è¡Œå‚æ•°

```
positional arguments:
  log_path              è®­ç»ƒæ—¥å¿—CSVæ–‡ä»¶è·¯å¾„

optional arguments:
  -h, --help            æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
  --report, -r          ç”Ÿæˆå®Œæ•´æŠ¥å‘Šï¼ˆåŒ…æ‹¬å›¾è¡¨ï¼‰
  --detailed, -d        æ˜¾ç¤ºè¯¦ç»†æ—¥å¿—
  --rows N, -n N        æ˜¾ç¤ºçš„è¯¦ç»†æ—¥å¿—è¡Œæ•°ï¼ˆé»˜è®¤10ï¼‰
  --output DIR, -o DIR  è¾“å‡ºç›®å½•ï¼ˆé»˜è®¤ä¸ºCSVæ‰€åœ¨ç›®å½•ï¼‰
```

## å®éªŒæ–‡ä»¶å¤¹ç»“æ„

è®­ç»ƒå®Œæˆåï¼Œæ¯ä¸ªå®éªŒéƒ½ä¼šç”Ÿæˆç‹¬ç«‹çš„æ–‡ä»¶å¤¹ï¼ŒåŒ…å«ï¼š

```
checkpoints/
â””â”€â”€ bert_squad_nc20_comm100_20251107_013508/
    â”œâ”€â”€ config.json                    # å®éªŒé…ç½®
    â”œâ”€â”€ training_log.csv               # è¯¦ç»†è®­ç»ƒæ—¥å¿—
    â”œâ”€â”€ training_progress.png          # è®­ç»ƒæ›²çº¿å¯è§†åŒ–
    â”œâ”€â”€ checkpoint_round_50.pth        # ä¸­é—´checkpoint
    â”œâ”€â”€ checkpoint_round_100.pth       # æœ€ç»ˆcheckpoint
    â”œâ”€â”€ final_model.pth                # æœ€ç»ˆæ¨¡å‹
    â”œâ”€â”€ training_report.png            # åˆ†ææŠ¥å‘Šï¼ˆä½¿ç”¨view_training_log.pyç”Ÿæˆï¼‰
    â””â”€â”€ training_summary.txt           # æ–‡æœ¬æ‘˜è¦ï¼ˆä½¿ç”¨view_training_log.pyç”Ÿæˆï¼‰
```

## ç¤ºä¾‹

### è¿è¡Œè®­ç»ƒ

```bash
python server.py -mn bert -dsn squad -nc 20 -cf 0.5 -E 2 -B 16 -lr 0.00002 -ncomm 100 -sf 50
```

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šå®æ—¶è¾“å‡ºï¼š
```
communicate round 1
lengths:[7.3174, 5.4738, 10.0]
round: 0, acc: 45.234, loss: 1.234
Checkpoint saved to checkpoints/bert_squad_nc20_comm100_20251107_013508/checkpoint_round_50.pth
...
```

### æŸ¥çœ‹ç»“æœ

```bash
# 1. æŸ¥çœ‹æ‘˜è¦
python scripts/view_training_log.py checkpoints/bert_squad_nc20_comm100_20251107_013508/training_log.csv

# 2. ç”Ÿæˆå®Œæ•´æŠ¥å‘Š
python scripts/view_training_log.py checkpoints/bert_squad_nc20_comm100_20251107_013508/training_log.csv --report

# 3. æŸ¥çœ‹è¯¦ç»†è®°å½•
python scripts/view_training_log.py checkpoints/bert_squad_nc20_comm100_20251107_013508/training_log.csv --detailed
```

## æ•°æ®æ ¼å¼

### CSV æ ¼å¼ç¤ºä¾‹

```csv
Round,Accuracy,Loss,Length_1,Length_2,Length_3
1,45.2340,1.234567,7.317400,5.473800,10.000000
2,48.5670,1.123456,7.234500,5.567800,9.890000
3,51.2340,1.056789,7.456700,5.678900,9.780000
...
```

### Checkpoint å†…å®¹

```python
checkpoint = {
    'round': 50,
    'model_state_dict': {...},
    'optimizer_state_dict': {...},
    'accuracy': 75.23,
    'loss': 0.456,
    'lengths': [7.3174, 5.4738, 10.0]
}
```

## æ³¨æ„äº‹é¡¹

1. **CSVæ–‡ä»¶å®æ—¶æ›´æ–°**: è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¯å®Œæˆä¸€è½®éƒ½ä¼šç«‹å³å†™å…¥CSVæ–‡ä»¶ï¼Œå³ä½¿è®­ç»ƒä¸­æ–­ä¹Ÿèƒ½ä¿ç•™å·²æœ‰æ•°æ®
2. **ç¼–ç é•¿åº¦**: å¦‚æœæ¨¡å‹æ²¡æœ‰ç¼–ç é•¿åº¦æ•°æ®ï¼Œå¯¹åº”åˆ—ä¼šæ˜¾ç¤º 'N/A'
3. **å›¾è¡¨ç”Ÿæˆ**: éœ€è¦å®‰è£… matplotlib å’Œ pandas åº“
4. **æ–‡ä»¶æƒé™**: ç¡®ä¿æœ‰å†™å…¥checkpointsç›®å½•çš„æƒé™

## ä¾èµ–é¡¹

```bash
pip install pandas matplotlib numpy torch
```

## æ•…éšœæ’é™¤

### é—®é¢˜1: æ‰¾ä¸åˆ°CSVæ–‡ä»¶
**è§£å†³æ–¹æ¡ˆ**: ç¡®è®¤è®­ç»ƒå·²ç»å¼€å§‹å¹¶è‡³å°‘å®Œæˆä¸€è½®

### é—®é¢˜2: å›¾è¡¨æ— æ³•ç”Ÿæˆ
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥æ˜¯å¦å®‰è£…äº†matplotlibå’Œpandas
```bash
pip install matplotlib pandas
```

### é—®é¢˜3: ç¼–ç é•¿åº¦æ˜¾ç¤ºä¸ºN/A
**è§£å†³æ–¹æ¡ˆ**: è¿™æ˜¯æ­£å¸¸çš„ï¼ŒæŸäº›æ¨¡å‹é…ç½®ä¸‹å¯èƒ½ä¸è®¡ç®—ç¼–ç é•¿åº¦

## æ›´æ–°æ—¥å¿—

### Version 1.0 (2025-11-07)
- âœ… æ–°å¢CSVæ—¥å¿—è®°å½•åŠŸèƒ½
- âœ… æ–°å¢ç¼–ç é•¿åº¦æ›²çº¿å¯è§†åŒ–
- âœ… å¢å¼ºcheckpointå†…å®¹
- âœ… æ–°å¢è®­ç»ƒæ—¥å¿—æŸ¥çœ‹å·¥å…·
- âœ… æ–°å¢è¯¦ç»†åˆ†ææŠ¥å‘Šç”Ÿæˆ
